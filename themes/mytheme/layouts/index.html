{{ define "main" }}

  <main class="wrap">
    <div class="grid" id="grid">
      
      <!-- Linker Kolom -->

      <section class="col left" id="left-col">
        <div class="pane" id="left-reeksen">

          <div class="block-links">
          <a href="#">Over vertalen</a><br><br>
          <a href="#">VVV</a><br><br>
          <a href="#">Gevonden Poëzie</a><br><br>
          <a href="#">Praatziek</a><br><br>
          <a href="#">Stand van zaken</a><br><br>
          <a href="#">Cryptofylie</a><br><br>
          <a href="#">Letterlijk, natuurlijk</a><br><br>

        </div></div>

        <div class="pane" id="left-genres">

            <div class="block-links">
           
            <a href="#">Over herdenken</a><br><br>
            <a href="#">Praatziek</a><br><br>
        <a href="#">e-mail</a><br><br>
        <a href="#">Poëzie</a><br><br>
        <a href="#">Verhaal</a><br><br>
        <a href="#">Essay</a><br><br>
        <a href="#">Recensie</a><br>
    </div>

      </div>

      <!-- Auteurs -->

        <div class="pane hidden" id="left-auteurs">
          <article class="block-links">
            
            <a href="#">Obe Alkema</a><br><br>
            <a href="#">Justine Armand de Court</a><br><br>
            <a href="#">Yi Fong Au</a><br><br>
            <a href="#">Tommy van Avermaete</a><br><br>
            <a href="#">Ane Baztarrika</a><br><br>
<a href="#">Thomas Baaij</a><br><br>
<a href="#">Rob H. Bekker</a><br><br>
<a href="#">Niels Bierens</a><br><br>
<a href="#">Siebe Bluijs</a><br><br>
<a href="#">Paul Buckley</a><br><br>
<a href="#">Dries van Doorn</a><br><br>
<a href="#">Arjen Duinker</a><br><br>
<a href="#">Esther Edelmann</a><br><br>
<a href="#">Borus Fortuin</a><br><br>
<a href="#">Bart Gansedijk</a><br><br>
<a href="#">Sebastiaan Garretse</a><br><br>
<a href="#">Jessie de Geus</a><br><br>
<a href="#">Nils Geylen</a><br><br>
<a href="#">Marijke Gravemaker</a><br><br>
<a href="#">Jurgen Gravestein</a><br><br>
<a href="#">Karel Großstadt</a><br><br>
<a href="#">Esha Guy Hadjadj</a><br><br>
<a href="#">Kees ’t Hart</a><br><br>
<a href="#">Tamara Hartman</a><br><br>
<a href="#">Nike van Helden</a><br><br>
<a href="#">Anne van der Horst</a><br><br>
<a href="#">Bram Ieven</a><br><br>
<a href="#">Nele Janssens</a><br><br>
<a href="#">Pablo Kattenberg</a><br><br>
<a href="#">Frank Keizer</a><br><br>
<a href="#">Lies Kelder</a><br><br>
<a href="#">Renée van den Kerkhof</a><br><br>
<a href="#">Marilou Klapwijk</a><br><br>
<a href="#">Bas Kleijweg</a><br><br>
<a href="#">Leon Kleinveld</a><br><br>
<a href="#">Vera Koot</a><br><br>
<a href="#">Frans-Willem Korsten</a><br><br>
<a href="#">Marc Kregting</a><br><br>
<a href="#">Madelief Lammers</a><br><br>
<a href="#">Wim Lankriet</a><br><br>
<a href="#">Jelmer van Lenteren</a><br><br>
<a href="#">Abel Lingezoon</a><br><br>
<a href="#">Hubertus Mayr</a><br><br>
<a href="#">Lars Meijer</a><br><br>
<a href="#">Anja Meulenbelt</a><br><br>
<a href="#">Lian Moerenhout</a><br><br>
<a href="#">Anke van Oostveen</a><br><br>
<a href="#">Mark Opfer</a><br><br>
<a href="#">Marieke Ornelis</a><br><br>
<a href="#">Jan Mulock Houwer</a><br><br>
<a href="#">Youna Mulock Houwer</a><br><br>
<a href="#">Thalia Ostendorf</a><br><br>
<a href="#">Merel Oudshoorn</a><br><br>
<a href="#">Norbert Peeters</a><br><br>
<a href="#">Nele Peeters</a><br><br>
<a href="#">Sara Polak</a><br><br>
<a href="#">Rakshasa Rakshindra</a><br><br>
<a href="#">Andrew Ricca</a><br><br>
<a href="#">Aafke Romeijn</a><br><br>
<a href="#">Zadok Samson</a><br><br>
<a href="#">Sven Schaepkens</a><br><br>
<a href="#">Lieke Smits</a><br><br>
<a href="#">Jurjen Simmelink</a><br><br>
<a href="#">Ruud Smulders</a><br><br>
<a href="#">Rico Sneller</a><br><br>
<a href="#">Benjamin Schoonenberg</a><br><br>
<a href="#">Wijnand Steemers</a><br><br>
<a href="#">Willemijn Stokvis</a><br><br>
<a href="#">Nathan Trantaal</a><br><br>
<a href="#">Marwin Vos</a><br><br>
<a href="#">Jos Westerhuis</a><br><br>
<a href="#">Yael van der Wouden</a><br><br>
<a href="#">Tessa de Zeeuw</a><br><br>
<a href="#">Elise Zoetmulder</a><br><br>

          </article>
        </div>

        <!-- Zoeken -->

        <div class="pane" id="left-zoeken">

            <div class="block-links">
            <h3>Zoeken</h3><br>
            <form class="search-form" role="search" aria-label="Zoeken in artikelen" data-search-form>
              <label class="sr-only" for="pane-site-search">Zoeken</label>
          <div class="search-input-group">
            <input id="pane-site-search" name="q" type="search" placeholder="Zoek in SKUT" autocomplete="off" data-search-input data-search-source="pane" />
            <!-- <button type="submit" class="search-submit">Zoek</button> -->
          </div>
        </form>
      

        </div></div>

        <!-- Toegankelijkheid -->
        <div class="pane" id="left-aA">

            <div class="block-links">
            <h3>aA</h3><br>

            <div class="accessibility-controls" role="group" aria-label="Toegankelijkheidsopties">
              <div class="control-row">
                <span class="control-label">Contrast</span>
                <button type="button" class="control-button contrast-toggle" data-action="toggle-contrast" aria-pressed="false">
                  Donker thema
                </button>
              </div>
              <div class="control-row">
                <span class="control-label">Tekstgrootte</span>
                <div class="font-size-controls" role="group" aria-label="Tekstgrootte">
                  <button type="button" class="control-button font-decrease" data-action="font-decrease" aria-label="Verklein tekst">
                    A-
                  </button>
                  <button type="button" class="control-button font-reset" data-action="font-reset" aria-label="Herstel tekstgrootte">
                    A
                  </button>
                  <button type="button" class="control-button font-increase" data-action="font-increase" aria-label="Vergroot tekst">
                    A+
                  </button>
                </div>
              </div>
            </div>

        </div>

      </div>
      </section>

      <!-- Midden Kolom -->
      <section class="col middle" id="middle-col">
        <div class="pane active" id="middle-titels">
          <div id="titles"></div>

        </div>
      </section>

      <!-- Rechter Kolom -->

      <aside class="col right" id="right-col">
        <div class="pane hidden" id="right-over">
          <div class="block-right">
            <b>SKUT</b> is een digitaal platform voor literatuur, kritiek en dialoog, dat middels brieven, essays, verhalend proza en poëzie het engagement opzoekt.
          </div>
          <div class="block-right">
            <b>Redactie</b>
            <p>Yi Fong Au<br>Pablo Kattenberg<br>Lies Kelder<br>Leon Kleinveld<br>Youna Mulock Houwer<br>Benjamin Schoonenberg</p>
            <b>Contact &amp; kopij</b>
            <p>Berichten en kopij: <a class="link" href="mailto:redactie@tijdschriftskut.nl">redactie@tijdschriftskut.nl</a></p>
            <p>Je kunt ons ook vinden op <a class="link" href="#">Instagram</a></p>
            <b>Nieuwsbrief</b>
            <p>Wij sturen een regelmatige nieuwsbrief over <b>SKUT</b>.</p>
            <form><input type="email" placeholder="e-mail adres" /> <a class="link" href="#">aanmelden</a></form>
          </div>
        </div>

        <div class="pane" id="right-steun">
          <div class="block-right">
            Wilt u ons ondersteunen of heeft u hier vragen over?
            Stuur een e-mail naar: stichting@tijdschriftskut.nl

            IBAN-rekeningnummer: NL16 RABO 0318 8988 10
            BIC: RABONL2U
                        </div>
                        <div class="block-right">
            <h3>Missie, doelstellingen en activiteiten</h3>
            Wat is een leefbare en levendige literaire cultuur? En hoe dragen wij hieraan bij? <br>
            <br>
            Dit zijn grote vragen inderdaad, waar het laatste woord nog lang niet over gezegd is, maar wij hebben alvast drie doelstellingen geformuleerd binnen het kader van het (digitale) literaire tijdschrift:
            <br><br>
            het brengen van experimentele vernieuwing in de Nederlandstalige literaire cultuur;<br>
            het aanwakkeren van een geëngageerde houding van de literaire cultuur tegenover de bredere en werkelijke samenleving waarin zij actief is;<br>
            de activering van ontwikkelend talent en ongevestigde schrijvers; het streven naar een toegankelijke schrijfcultuur waarin participatie centraal staat.<br>
            Dit kunnen wij natuurlijk niet alleen. Goed literair werk, zoals de term doet vermoeden, is werk. Het moet geschreven worden (met veel dank aan al onze imponerende auteurs), en het moet gelezen worden. Daar komt u om de hoek kijken. Zonder de lezer zouden wij deze prachtige experimenten het zwarte gat van het internet insturen, zonder deze ooit weer terug te zien.
            <br><br>
            <b>SKUT</b> is sinds 2015 actief als online/digitaal literair tijdschrift met enkele publicaties per maand.
            <br><br>
            De gehele organisatie drijft momenteel op de kracht van vrijwilligers. De verschillende functies binnen het tijdschrift worden uitgevoerd door een groep redacteur-directeuren als vrijwilligers. SKUT ontvangt donatiegelden van donateurs en krijgt voor de periode 2024-2026 een bijdrage van het Cultuurfonds voor het project Utopia Marginalia.
            <br><br>
                            <h3>Bijdragen en belastingvoordeel</h3>
            Wilt u niet alleen bijdragen door SKUT te lezen, maar ook via een gift? Dat kan!
            <br><br>
            Uw bijdrage komt ten goede aan SKUT en de gehele sfeer van het Nederlandse literaire tijdschrift. Deze bijdrage zorgt ervoor dat talentvolle schrijvers een vergoeding kunnen ontvangen voor hun werk binnen een niet-commerciële ruimte, en zich daarin kunnen ontwikkelen.
            <br><br>
            Stichting SKUT, als de stichting die tijdschrift SKUT mogelijk maakt, heeft een culturele ANBI-status. Dit betekent dat de stichting als goed doel is vrijgesteld van betaling van schenk- en erfbelasting. U kunt de stichting steunen middels kleinere of grotere schenkingen, legaten en nalatenschappen. Alles over de geefwet staat hier op de website van de belastingdienst.
            <br><br>
            Voor meer informatie staan we U graag ter woord via elektronische correspondentie: stichting@tijdschriftskut.nl
            <br><br>
            <h3>Verkort beleidsplan</h3>
            De eerste beleidsperiode van Stichting SKUT, 2024-2027,  staat in het teken van een professionaliseringsslag van het sinds 2015 bestaande tijdschrift SKUT. We werken aan de ontwikkeling van een professionele redactie en een grotere publicatie-activiteit, ondersteund door nieuwe processen zoals bestuurlijke besluitvorming en fondsenwerving. Inkomsten uit fondsenwerving en donaties zullen ons in staat stellen ambitieuzere projecten te financieren en meer aandacht te besteden aan redactioneel werk.
            <br><br>
            Het is belangrijk dat SKUT een maatschappelijk aanvaardbaar beloningsbeleid creëert voor de gewerkte uren van de redactie, zodat we van een onbetaalde vrijwilligersorganisatie naar een organisatie met enige vergoeding voor vrijwilligers kunnen groeien. Inhoudelijk zetten we de bestaande traditie van SKUT voort, en zoeken we naar mogelijkheden om het aantal publicaties gestaag te laten groeien.
            <br><br>
            De stichting beoogt daarbij niet het maken van winst, en ten minste 90% van de activiteiten wordt uitgevoerd in het kader van het algemeen-cultureel belang. Dit blijkt ook uit haar feitelijke omstandigheden: de stichting laat de opbrengsten van haar vermogen ten goede komen van de doelstellingen en een batig saldo moet worden besteed conform deze doelstellingen. Het vermogen wordt beheerd door een gezamenlijk bevoegd bestuur van ten minste drie leden.
            <br><br>
            Het volledige beleidsplan 2024-2027 kan hier bekeken worden.
            <br><br>
            <h3>Jaarverslagen</h3>
            Jaarrekening 2024
            <br><br>
            Jaarverslag 2024
            <br><br>
            <h3>Bestuursleden</h3>
            Dhr. Tommy van Avermaete (voorzitter)<br>
            Dhr. Tinne Zandstra (penningmeester)<br>
            Mevr. Sophie van den Bergh (secretaris)<br>
            Mevr. Nike van Helden (algemeen bestuurslid)<br>
            Dhr. Bram Ieven (algemeen bestuurslid)<br>
            <br>
            <h3>Redacteuren-directeuren</h3>
            Dhr. Yi Fong Au<br>
            Dhr. Leon Kleinveld<br>
            Dhr. Benjamin Schoonenberg<br>
            Dhr. Pablo Kattenberg<br>
            Mevr. Youna Mulock Houwer<br>
            Mevr. Lies Kelder<br>
            <br>
            ANBI-informatie<br>
            IBAN-rekeningnummer: NL16 RABO 0318 8988 10<br>
            BIC: RABONL2U<br>
            <br>
            Statutaire naam: Stichting SKUT<br>
            KvK-nummer: 93226233<br>
            RSIN: 866319049<br>
            E-mail: stichting@tijdschriftskut.nl<br>
            Postadres: op aanvraag beschikbaar<br>
            <br>
            Leden van het bestuur hebben geen recht op vacatiegeld ter zake van hun werkzaamheden voor de stichting noch hebben zij recht op een beloning voor andere werkzaamheden. Wel kunnen zij recht hebben op vergoeding van de door hen in uitoefening van hun functie (in redelijkheid) gemaakte kosten. De omschreven vergoedingen worden in de jaarrekening van de stichting zichtbaar gemaakt en nader toegelicht.
            <br>
            De directie ontvangt een vrijwilligersvergoeding.</div> </div></div>
                  </aside>
    </div>
  </main>
<script>

    let leftVisible = false;
    let rightVisible = false;

  
    const titlesByKey = {
      "Obe Alkema": [
        {
          title: "Cyclus III — de ratten",
          meta: "Justine Armand de Court — 26 juli 2025",
          tag: "Over Kees Ouwens",
          img: "",
          content: `<div class="artikel"><p class="artikeltekst">
           Hey Frank,
<br><br>
Dat verwoord je treffend: poëzie tegen biopolitiek. Daar ben ik de afgelopen weken ook veel mee bezig geweest.
<br><br>
Het Ouwens-project lijkt me niet los te laten; het heeft zelfs wortel geschoten in een andere publicatie. Zo werkte ik de afgelopen weken aan een essay dat onderhand op Versopolis is verschenen, waarin ik op zoek ga naar de lichamelijke openingen (of potentialiteiten) in de gedichten van Ouwens. In het stuk beargumenteerde ik dat die beweging in zijn werk, als een queer houding kan worden gelezen. Hiermee doelde ik niet per se op queer als een seksualiteit – hoewel dit ook mogelijk is – maar eerder als een gevoel van afwijking, van datgene wat zich verzet tegen begrenzing. In de gedichten van Ouwens wordt constant ruimte overgelaten voor het lichaam om fouten te maken, waardoor het constant opnieuw kan worden uitgevonden en in elkaar gezet. In het essay bespreek ik bijvoorbeeld ‘Exil’ uit Klem. In mijn lezing wordt mannelijkheid niet voorgesteld als iets essentieels. In plaats daarvan wordt de veronderstelde stabiliteit van het woord ‘man’ kneedbaar gemaakt, in staat om door middel van taal te worden ontmanteld en opnieuw samengesteld.
<br><br>
Zoals jij ook stelt, wordt op het lichaam waarover Ouwens schrijft ingewerkt; het poreuze karakter van zijn subjecten wordt daardoor vatbaar voor verschillende invloeden. Of, zoals Marc Kregting in het stuk De verborgen derde persoon, uit overzichtswerk En gene schitterde op de rede, schrijft: “Het stereoptiep mannelijke en vrouwelijke lijken verruild. Laat ik zeggen dat Ouwens hermafroditische literatuur bedrijft.” Ik weet niet of ik Kregting in deze omschrijving volg – de terminologie die hij gebruikt is ook sterk verouderd – maar het sentiment deel ik wel, namelijk de meervoudigheid van het dichtwerk.
<br><br>
In het reflecteren op je brief dacht ik ook na over een term waar ik geen ruimte voor zag in mijn essay, en die ook nog geen ingang heeft gevonden in onze correspondentie. Ik meen dit te kunnen toeschrijven aan het feit dat we allebei weinig thuis zijn in het prozawerk van Ouwens, maar de term in kwestie lijkt me relevant voor datgene wat we proberen te ontginnen. Ik heb het namelijk over de term ‘retroseksualiteit’ die Ouwens actief gebruikte als betekenisgever in zijn (vrijwel ongelezen) prozawerk. Het is nogal een glibberig begrip – ook na research voel ik me met een kluitje het riet in gestuurd – maar een mogelijk antwoord vond ik in een bespreking van het verzameld werk in krant De Morgen: “De retroseksualiteit is geen geaardheid maar een goed recht, een correctie op de natuur (…) De retroseksuele wil keert terug naar de stand van zaken (…) zijn doel is behoud van vooruitzicht, het geborchte als de tijd van voor de gang van zaken, door de herhaling verzekerd (…) De consumptie, niet de consummatie is een eerste levensbehoefte. De retroseksueel leeft daarom niet in onthouding maar in het reine.”
<br><br>
Ook in het essay De realiteit van de fictie, uit hetzelfde eerder genoemde overzichtswerk, waar Ouwens uitvoerig wordt geïnterviewd door Toine Moerbeek, zegt hij het volgende over deze seksualiteitsopvatting:
<br><br>
Toine Moerbeek: “In Een twee drie vier introduceerde je de term ‘retroseksualiteit’. Ook toen splitste je je personages op in meerdere identiteiten. In je nieuwste boek stel je expliciet dat elke Ik twee Zelven heeft. Er is steeds een kant van het personage dat niet getoond kan worden, maar dat aangevuld moet worden met een alter ego. Wat voor het personage geldt, geldt ook voor de auteur, die immers via zijn personages iets van zichzelf toont. ‘Retro’ betekent ’terug’, ’terugwaarts’; ‘vade retro satanas’ staat er in de bijbel, ‘ga terug, Satan!’ Wil je de duivel uit jezelf uitdrijven?”
<br><br>
Kees Ouwens: “Retroseksualiteit – retour de la sexualité; een wending of keer maar een afdanking. Sexualiteit – ik neem het woord afkerig in de mond – is het een deugd? Vervang de x door ks, wat houd je over? Een versnapering: seks. De retroseksualiteit is dus niet een spaaklopen, slechts een vrijzwevend blijven, en bepaald een bestemming. (…) Anders gezegd: het eind is niet zoek, het houdt zich schuil in de aanvang.”
Wanneer we nadenken over onze eigen tweeledigheden – in coördinaten en genealogieën – kan het bijna niet anders dan dat wij ook, op een bepaalde manier, ons een retroseksuele houding aanmeten: “zijn doel is behoud van vooruitzicht, het geborchte als de tijd van voor de gang van zaken, door de herhaling verzekerd.”
<br><br>
Wanneer ik lees dat je vraag naar herkomstigheid zich ook aan je opdringt in de vorm van een grondgelaagdheid, vind ik dit erg herkenbaar. Ik denk gelijk aan een een gedicht uit Mythologieën: “Ook ik, op de rand van de aardbreuk / in licht als een schaduw, / ver boven het rijk in de diepte, / wist dat ik het was, zoals zij beneden / mijn leeftijden als voorbije lichamen, / mij als hun overkant zagen”. Het constant afscheid nemen van wat voorbij is, maar bewust zijn van de ‘voorbije lichamen’ die, als een vervelende huid, achterblijven. De diepte, niet een plek om naar terug te keren – à la Het land van herkomst – maar als de herinnering aan de meervoudigheid die constant aan het zelf verbonden is.
<br><br>
Dit is iets wat ik zelf herken, en dit gevoel heb ik geprobeerd in het essay voor Versopolis te vangen. De vormen van groei, zoals Ouwens dat treffend omschrijft, openen mogelijkheden om verschillende erfenissen, intern en extern, te kunnen opgraven. In een ander gedicht (ook uit de bundel Mythologieën) komt dit helder naar voren: “Ik, beeldspraak, mijn gelijke, en hij / de mij sprekende, mijn vergelijker, komen / thuis, gaan naar buiten, komen de wijk / uit, stellen zonder ons kan het de zelfde / en hoor het lachen der symbolen”. Hierbij moet ik gelijk denken aan hoe het man-zijn wordt vormgegeven. Niet door wezenlijke (of essentialistische) eigenschappen, maar door verhalen van anderen, door beeldspraak. Deze vertaalslag mislukt echter altijd, waarop het “lachen der symbolen” volgt.
<br><br>
Jouw observatie dat “de verleden tijd hier [in de gedichten uit Klem] vooral als het vastzitten in het verleden, als de onmogelijkheid om te rouwen” moet worden gelezen, vind ik dan ook scherp en vooral ontroerend. Het lijkt me dat dit is wat Ouwens bedoelt, wanneer hij retroseksualiteit niet ziet als een vorm van spaaklopen – wat een hapering impliceert – maar als een vrijzwevend blijven. Niet volledig op de plaats van herkomst zijn, maar blijven waar er nog ruimte is voor verandering, voor ingrepen in de omgeving, of deze nu lichamelijk of maatschappelijk is.
<br><br>
Misschien is dat ook waarom ik bij Ouwens telkens een soort thuiskomst ervaar, hoe omwegachtig en meervoudig die ook is. Zijn poëzie lijkt zich steeds te bewegen tussen verlies en heruitvinding, tussen bron en ommuring, zoals jij dat zo mooi omschreef met je “grondgelaagdheid”.
<br><br>
Ik blijf benieuwd hoe jij dat ervaart: of die beweging voor jou ook voelt als een vrijzwevend blijven, of juist als een poging om toch ergens wortel te schieten.
<br><br>
Veel warms,<br>
Lars</p></div>` 
        },
        {
          title: "Over Kees Ouwens V",
          meta: "Lars Meijer — 11 augustus 2025",
          tag: "Over Kees Ouwens",
          img: "",
          content: `<div class="artikel"><p>

            <img src="AnkePoem_1_Final_Cropped.png" width="440"> <br><br>
            ik rook shag iets dat ik niet doe.<br>
mijn naam een echo van moeders,<br>
met een minnaar kan ik zijn zonder dat te weten,<br>
een gedragen leegte boven mijn romp<br>
<br>
je legt me neer op een vloerkleed van paardenhaar.<br>
we horen geen hartenklop, je pelt de huid<br>
van mijn huid, gaat door tot ik overblijf<br><br>

tot zichtbaar is mijn denkbare vruchtvlees.<br>
wie kan mij raken nu ik bloot ben,<br>
nu nachtlicht zijn schaduw werpt op hals en borsten<br>
en een polsslag zich laat vinden.<br><br>

ik werd schreeuwend geboren<br>
ik hoef niet naar bloesem te ruiken, niet te glimlachen<br>
om die andere lach te verbergen.<br><br>

we praten niet, we praten<br>
niet over wonden op knieën en rug<br>
<br>
vertellen wat er gebeurde.<br>
<br>
in het donker heeft de dag houvast<br>
aan het bed: het delven kan<br>
<br>
beginnen mijn ogen aan de nacht<br>
wereld ontvouwt zich als vanzelf aan het lichaam<br>
<br>
terug. ik ben de plek waar ik heen ga ik jeuk<br>
als een wondje dat herstelt. wegblijven gaat<br>
<br>
moeilijk reik ik door het inwendige broedsel<br>
van mijn leven, naar wat de dag in mij plantte<br>
<br>
bij licht, bij mens eindig ik. klopt mijn hart alleen<br>
in mijn oor. zo drijf ik aan de oppervlakte<br>
<br>
een zalmkleurige olievlek<br>
als een kannibaal begin ik te eten van de pijn<br>
<br>
<img src="AnkePoem_4_Final_Cropped.png" width="420">
</p></div>`
        },
        {
          title: "Laboria Cuboniks — Xenofeministisch Manifest: ZERO",
          meta: "Lies Kelder (vert.) — 18 maart 2025",
          tag: "Poëzie",
          // img: "Screenshot 2025-08-16 at 14.38.48.png",
          content: `<div class="artikel"><p>Gedicht / manifest-tekst. Je kunt ook regels <br> breken of afbeeldingen invoegen.</p></div>`
        },
        {
          title: "Over Kees Ouwens III",
          meta: "Lars Meijer — 19 juli 2025",
          tag: "Over Kees Ouwens",
          img: "",
          content: `<div class="artikel"><p>Korte intro en daarna de volledige tekst…</p></div>`
        },
        {
          title: "Over Kees Ouwens II",
          meta: "Frank Keizer — 8 juli 2025",
          tag: "Over Kees Ouwens",
          img: "",
          content: `<div class="artikel"><p>Volledige bijdrage van Frank Keizer.</p></div>`
        },
        {
          title: "Over Kees Ouwens",
          meta: "Lars Meijer — 27 juni 2025",
          tag: "Over Kees Ouwens",
          img: "",
          content: `<div class="artikel"><p>De eerste in de reeks.</p></div>`
        },
        {
          title: "Het is de hulpeloosheid die hen breekt",
          meta: "Leon Kleinveld —  9 juni 2025",
          tag: "Verhaal",
          img: "",
          content: `<div class="artikel"><p>Verhaaltekst…</p></div>`
        }
      ]
    };

    const searchIndex = buildSearchIndex(titlesByKey);
    let lastTrackedList = [];
    let suppressRenderTracking = false;
    let searchActive = false;
    let previousLeftMenuSelection = null;

   
    let uidCounter = 0;
    function uid(prefix = "id") {
      uidCounter += 1;
      return `${prefix}-${Date.now()}-${uidCounter}`;
    }

   
    function renderTitles(list) {
      const container = document.getElementById('titles');
      if (!container) return;

      const items = Array.isArray(list) ? list : [];
      if (!suppressRenderTracking) {
        lastTrackedList = items;
        searchActive = false;
      }

      container.innerHTML = '';

      items.forEach(item => {
        const articleId = uid('art');
        const contentId = uid('content');

        const el = document.createElement('article');
        el.className = 'block';
        el.setAttribute('data-article-id', articleId);

       
        el.innerHTML = `
          ${item.tag ? `<div class="meta">${item.tag}</div>` : ''}
          <h3 class="title">
            <button type="button"
                    class="title-toggle"
                    aria-expanded="false"
                    aria-controls="${contentId}">
              ${item.title}
            </button>
          </h3>
          ${item.meta ? `<div class="kicker">${item.meta}</div>` : ''}
          ${item.img ? `<img class="titleimg" src="${item.img}" alt="">` : ''}

          <div id="${contentId}" class="content" hidden>
            ${item.content ? item.content : ''}
          </div>
        `;
        container.appendChild(el);
      });

      if (!items || items.length === 0) {
        const empty = document.createElement('div');
        empty.className = 'block';
        empty.textContent = 'Geen titels.';
        container.appendChild(empty);
      }
    }

    function buildSearchIndex(map) {
      const entries = [];
      Object.entries(map || {}).forEach(([key, items]) => {
        (items || []).forEach(item => {
          const textBlob = [
            key,
            item?.title,
            item?.meta,
            item?.tag,
            stripHTML(item?.content || '')
          ].filter(Boolean).join(' ');
          entries.push({
            key,
            item,
            searchBlob: normalizeText(textBlob),
          });
        });
      });
      return entries;
    }

    function stripHTML(value) {
      return (value || '')
        .replace(/<style[^>]*>[\s\S]*?<\/style>/gi, ' ')
        .replace(/<script[^>]*>[\s\S]*?<\/script>/gi, ' ')
        .replace(/<[^>]+>/g, ' ')
        .replace(/\s+/g, ' ')
        .trim();
    }

    function normalizeText(value) {
      return (value || '')
        .toString()
        .normalize('NFD')
        .replace(/[\u0300-\u036f]/g, '')
        .toLowerCase();
    }

    function combineSearchTag(key, tag) {
      const cleanKey = (key || '').trim();
      const cleanTag = (tag || '').trim();
      if (!cleanKey && !cleanTag) return '';
      if (!cleanTag) return cleanKey;
      if (!cleanKey) return cleanTag;
      if (normalizeText(cleanKey) === normalizeText(cleanTag)) return cleanTag;
      return `${cleanKey} · ${cleanTag}`;
    }

    document.getElementById('middle-col')?.addEventListener('click', (e) => {
      const btn = e.target.closest('.title-toggle');
      if (!btn) return;

      const contentId = btn.getAttribute('aria-controls');
      const contentEl = document.getElementById(contentId);
      if (!contentEl) return;

      const isOpen = btn.getAttribute('aria-expanded') === 'true';

      btn.setAttribute('aria-expanded', String(!isOpen));
      if (isOpen) {
        collapse(contentEl);
      } else {
        expand(contentEl);
      }
    });

    function expand(el) {
  const article = el.closest('.block');
  article?.classList.add('open');
      if (!el) return;
      el.hidden = false;
      el.style.maxHeight = '0px';
      el.offsetHeight; 
      el.style.transition = 'max-height 0.3s ease';
      el.style.maxHeight = el.scrollHeight + 'px';

      const onEnd = (evt) => {
        if (evt.propertyName !== 'max-height') return;
        el.style.maxHeight = 'none';
        el.style.transition = '';
        el.removeEventListener('transitionend', onEnd);
      };
      el.addEventListener('transitionend', onEnd, { once: true });
    }

    function collapse(el) {
  const article = el.closest('.block');
  article?.classList.remove('open');
      if (!el) return;
      el.style.transition = '';
      el.style.maxHeight = el.scrollHeight + 'px';
      el.offsetHeight; 
      el.style.transition = 'max-height 0.3s ease';
      el.style.maxHeight = '0px';

      const onEnd = (evt) => {
        if (evt.propertyName !== 'max-height') return;
        el.hidden = true;
        el.style.transition = '';
        el.removeEventListener('transitionend', onEnd);
      };
      el.addEventListener('transitionend', onEnd, { once: true });
    }

    function createPaneCloseButtons() {
      document.querySelectorAll('.pane').forEach(pane => {
        if (pane.querySelector('.pane-close')) return;
        const id = pane.id || '';
        if (!id.startsWith('left-') && !id.startsWith('right-')) return;

        const side = id.startsWith('right-') ? 'right' : 'left';
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'pane-close';
        btn.setAttribute('aria-label', 'Sluit paneel');
        btn.innerHTML = '<span class="sr-only">Sluit paneel</span>';

        btn.addEventListener('click', () => {
          closeCol(side);
          document
            .querySelector(`.menu-${side} .menu a[aria-selected="true"]`)
            ?.setAttribute('aria-selected','false');
        });

        pane.insertBefore(btn, pane.firstChild);
      });
    }

    function setActivePane(side, target){
      const scope = side === 'left' ? '.left' : '.right';
      document.querySelectorAll(`${scope} .pane`).forEach(p => p.classList.remove('active'));
      const pane = document.getElementById(`${side}-${target}`);
      pane?.classList.add('active');
      if (pane) onPaneActivated(side, target, pane);
    }

    function onPaneActivated(side, target, pane) {
      if (side === 'left' && target === 'zoeken') {
        if (suppressNextSearchFocus) {
          suppressNextSearchFocus = false;
          return;
        }
        const searchInput = pane.querySelector('input[type="search"]');
        if (searchInput) {
          const alreadyFocused = document.activeElement === searchInput;
          const shouldSelect = !searchInput.value;
          requestAnimationFrame(() => {
            if (!alreadyFocused) {
              searchInput.focus();
            }
            if (shouldSelect) {
              searchInput.select();
            }
          });
        }
        suppressNextSearchFocus = false;
      }
    }


if (typeof leftVisible === 'undefined')  window.leftVisible  = false;
if (typeof rightVisible === 'undefined') window.rightVisible = false;

const MOBILE_BP = 900;
const gridEl   = document.getElementById('grid');
const leftEl   = document.querySelector('.left');
const rightEl  = document.querySelector('.right');
const bodyEl   = document.body;
const headerEl = document.querySelector('header');
const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
const mobileSearchToggle = document.querySelector('.mobile-search-toggle');
const menusContainer = document.getElementById('header-menus');
const contrastToggleBtn = document.querySelector('[data-action="toggle-contrast"]');
const fontButtons = document.querySelectorAll('.accessibility-controls [data-action^="font-"]');
const searchForms = Array.from(document.querySelectorAll('[data-search-form]'));
const searchInputs = searchForms
  .map(form => form.querySelector('[data-search-input]'))
  .filter(Boolean);
const paneSearchInput = searchInputs.find(input => input.dataset.searchSource === 'pane') || null;
const mobileSearchInput = searchInputs.find(input => input.dataset.searchSource === 'mobile') || null;
const searchHintEl = document.querySelector('.search-hint');
const defaultSearchHintText = searchHintEl?.textContent || '';
const FONT_SCALE_MIN = -3;
const FONT_SCALE_MAX = 3;
let suppressSearchInputSync = false;
let suppressNextSearchFocus = false;
let mobileSearchOpen = false;
let lastScrollY = 0;
let ticking = false;
let hidden = false;

const ACCESSIBILITY_STORAGE_KEY = 'skut-accessibility-preferences';
const defaultAccessibilityState = { contrast: false, fontScale: 0 };
let accessibilityState = loadAccessibilityState();

function loadAccessibilityState() {
  try {
    const raw = localStorage.getItem(ACCESSIBILITY_STORAGE_KEY);
    if (!raw) return { ...defaultAccessibilityState };
    const parsed = JSON.parse(raw);
    return {
      contrast: !!parsed.contrast,
      fontScale: typeof parsed.fontScale === 'number'
        ? Math.max(FONT_SCALE_MIN, Math.min(FONT_SCALE_MAX, Math.round(parsed.fontScale)))
        : 0,
    };
  } catch (err) {
    return { ...defaultAccessibilityState };
  }
}

function saveAccessibilityState() {
  try {
    localStorage.setItem(ACCESSIBILITY_STORAGE_KEY, JSON.stringify(accessibilityState));
  } catch (err) {
    /* storage not available */
  }
}

function applyContrastSetting(enabled) {
  bodyEl.classList.toggle('contrast-inverted', !!enabled);
  contrastToggleBtn?.setAttribute('aria-pressed', String(!!enabled));
}

function applyFontScaleSetting(scale) {
  if (!bodyEl) return;
  const clamped = Math.max(FONT_SCALE_MIN, Math.min(FONT_SCALE_MAX, Math.round(scale)));
  bodyEl.setAttribute('data-font-scale', String(clamped));
}

function updateFontButtons() {
  fontButtons.forEach(btn => {
    const action = btn.dataset.action;
    const current = accessibilityState.fontScale;
    let pressed = false;
    if (action === 'font-reset') {
      pressed = current === 0;
    }
    btn.setAttribute('aria-pressed', String(pressed));
    if (action === 'font-decrease') {
      btn.disabled = current <= FONT_SCALE_MIN;
    } else if (action === 'font-increase') {
      btn.disabled = current >= FONT_SCALE_MAX;
    } else {
      btn.disabled = false;
    }
  });
}

function applyAccessibilityState() {
  applyContrastSetting(accessibilityState.contrast);
  applyFontScaleSetting(accessibilityState.fontScale);
  updateFontButtons();
}

function setContrast(enabled) {
  accessibilityState = {
    ...accessibilityState,
    contrast: !!enabled,
  };
  applyContrastSetting(accessibilityState.contrast);
  saveAccessibilityState();
}

function setFontScale(value) {
  const clamped = Math.max(FONT_SCALE_MIN, Math.min(FONT_SCALE_MAX, Math.round(value)));
  accessibilityState = {
    ...accessibilityState,
    fontScale: clamped,
  };
  applyFontScaleSetting(accessibilityState.fontScale);
  updateFontButtons();
  saveAccessibilityState();
}

contrastToggleBtn?.addEventListener('click', () => {
  setContrast(!accessibilityState.contrast);
});

fontButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    const action = btn.dataset.action;
    if (action === 'font-decrease') {
      setFontScale(accessibilityState.fontScale - 1);
    } else if (action === 'font-increase') {
      setFontScale(accessibilityState.fontScale + 1);
    } else if (action === 'font-reset') {
      setFontScale(0);
    }
  });
});

applyAccessibilityState();

function resetSearchForm() {
  suppressSearchInputSync = true;
  searchInputs.forEach(input => {
    input.value = '';
  });
  suppressSearchInputSync = false;
  if (searchHintEl) searchHintEl.textContent = defaultSearchHintText;
  searchActive = false;
}

function syncSearchInputs(source, value) {
  if (suppressSearchInputSync) return;
  suppressSearchInputSync = true;
  searchInputs.forEach(input => {
    if (input === source) return;
    if (input.value !== value) input.value = value;
  });
  suppressSearchInputSync = false;
}

function focusSearchInput(preferMobile = false) {
  const candidates = [];
  if (preferMobile && mobileSearchInput) candidates.push(mobileSearchInput);
  if (paneSearchInput) candidates.push(paneSearchInput);
  if (!preferMobile && mobileSearchInput) candidates.push(mobileSearchInput);

  const target = candidates.find(input => document.contains(input));
  if (!target) return;
  requestAnimationFrame(() => {
    target.focus();
    if (!target.value) target.select();
  });
}

function setMobileSearch(open, options = {}) {
  const { focus = open, skipMenuSync = false } = options;
  const isMob = isMobile();
  if (!isMob) {
    if (mobileSearchOpen) {
      mobileSearchOpen = false;
      headerEl?.classList.remove('search-open');
      mobileSearchToggle?.setAttribute('aria-expanded', 'false');
      updateHeaderOffsetVar();
    }
    return;
  }

  const next = !!open;
  if (next === mobileSearchOpen) {
    if (next && focus) focusSearchInput(true);
    return;
  }

  mobileSearchOpen = next;
  headerEl?.classList.toggle('search-open', mobileSearchOpen);
  mobileSearchToggle?.setAttribute('aria-expanded', String(mobileSearchOpen));

  if (mobileSearchOpen) {
    if (!skipMenuSync) setMobileMenu(false);
    headerEl?.classList.remove('hide');
    hidden = false;
    leftVisible = false;
    rightVisible = false;
    applyLayout();
    focusSearchInput(true);
  } else if (focus) {
    const hasQuery = searchInputs.some(input => input.value.trim().length);
    if (!hasQuery) resetSearchForm();
  }

  updateHeaderOffsetVar();
}

function updateLeftMenuSelection(linkToSelect) {
  document.querySelectorAll('.menu-left .menu a').forEach(link => {
    link.setAttribute('aria-selected', String(link === linkToSelect));
  });
}

function performSearch(rawQuery, options = {}, sourceInput = null) {
  const query = (rawQuery || '').toString();
  const trimmed = query.trim();

  if (!trimmed) {
    searchActive = false;
    if (searchHintEl) {
      searchHintEl.textContent = options.announceEmpty
        ? 'Voer een zoekterm in.'
        : defaultSearchHintText;
    }
    suppressRenderTracking = true;
    const fallbackList = lastTrackedList && lastTrackedList.length
      ? lastTrackedList
      : (titlesByKey["Obe Alkema"] || []);
    renderTitles(fallbackList);
    suppressRenderTracking = false;
    const searchLink = document.querySelector('.menu-left .menu a[data-target="zoeken"]');
    if (searchLink) {
      searchLink.setAttribute('aria-selected', 'false');
    }
    if (previousLeftMenuSelection && document.body.contains(previousLeftMenuSelection)) {
      updateLeftMenuSelection(previousLeftMenuSelection);
    } else {
      updateLeftMenuSelection(null);
    }
    if (options.focusOnReset) {
      focusSearchInput(isMobile());
    }
    return;
  }

  const wasActive = searchActive;
  const normalized = normalizeText(trimmed);
  const matches = searchIndex
    .filter(entry => entry.searchBlob.includes(normalized))
    .map(entry => {
      const displayTag = combineSearchTag(entry.key, entry.item?.tag);
      if (displayTag === (entry.item?.tag || '')) {
        return entry.item;
      }
      return {
        ...entry.item,
        tag: displayTag,
      };
    });

  suppressRenderTracking = true;
  renderTitles(matches);
  suppressRenderTracking = false;

  if (searchHintEl) {
    if (matches.length > 0) {
      searchHintEl.textContent = `${matches.length} ${matches.length === 1 ? 'resultaat' : 'resultaten'} voor "${trimmed}".`;
    } else {
      searchHintEl.textContent = `Geen resultaten voor "${trimmed}".`;
    }
  }

  const searchLink = document.querySelector('.menu-left .menu a[data-target="zoeken"]');
  if (searchLink) {
    if (!wasActive) {
      const currentSelection = document.querySelector('.menu-left .menu a[aria-selected="true"]');
      if (currentSelection && currentSelection.dataset.target !== 'zoeken') {
        previousLeftMenuSelection = currentSelection;
      }
    }
    updateLeftMenuSelection(searchLink);
  }

  if (!wasActive) {
    const isMob = isMobile();
    const leftPaneEl = document.getElementById('left-zoeken');
    const sourceInsidePane = !!(sourceInput && leftPaneEl?.contains(sourceInput));
    suppressNextSearchFocus = !!sourceInput && !sourceInsidePane;
    setActivePane('left', 'zoeken');
    if (!isMob) {
      openCol('left');
    } else {
      leftVisible = false;
      rightVisible = false;
      applyLayout();
    }
    suppressNextSearchFocus = false;
  }
  searchActive = true;
}

searchForms.forEach(form => {
  const input = form.querySelector('[data-search-input]');
  if (!input) return;

  form.addEventListener('submit', (event) => {
    event.preventDefault();
    syncSearchInputs(input, input.value);
    performSearch(input.value || '', { announceEmpty: true, focusOnReset: true }, input);
  });

  input.addEventListener('input', (event) => {
    if (!(event.target instanceof HTMLInputElement)) return;
    if (!suppressSearchInputSync) {
      syncSearchInputs(input, event.target.value);
    }
    performSearch(event.target.value || '', {}, input);
  });
});

let backdropEl = null;     
let lastMobile = isMobile();
let mobileMenuOpen = false;

  function isMobile() {
  return window.innerWidth <= MOBILE_BP;
}

function ensureBackdrop() {
  if (backdropEl) return;
  backdropEl = document.createElement('div');
  backdropEl.className = 'overlay-backdrop';
  Object.assign(backdropEl.style, {
    position: 'fixed',
    left: '0',
    right: '0',
    bottom: '0',
    top: '0',
    background: 'rgba(0,0,0,0.15)',
    zIndex: '1999',
  });
  backdropEl.addEventListener('click', closeAll);
  document.body.appendChild(backdropEl);
  updateBackdropOffset();
}

function updateBackdropOffset() {
  if (!backdropEl) return;
  const header = headerEl;
  const headerHidden = header?.classList.contains('hide');
  const headerHeight = header && !headerHidden ? header.offsetHeight : 0;
  backdropEl.style.top = `${headerHeight}px`;
}

function updateHeaderOffsetVar() {
  const header = headerEl;
  const headerHidden = header?.classList.contains('hide');
  const headerHeight = header && !headerHidden ? header.offsetHeight : 0;
  document.documentElement.style.setProperty('--header-offset', `${headerHeight}px`);
}

function removeBackdrop() {
  if (!backdropEl) return;
  backdropEl.removeEventListener('click', closeAll);
  backdropEl.remove();
  backdropEl = null;
}

let savedOverflow = '';
function lockBodyScroll(lock) {
  if (lock) {
    if (!savedOverflow) savedOverflow = bodyEl.style.overflow || '';
    bodyEl.style.overflow = 'hidden';
  } else {
    bodyEl.style.overflow = savedOverflow;
    savedOverflow = '';
  }
}

function setMobileMenu(open) {
  if (!isMobile()) {
    mobileMenuOpen = false;
    headerEl?.classList.remove('menu-open');
    mobileMenuToggle?.setAttribute('aria-expanded', 'false');
    menusContainer?.removeAttribute('aria-hidden');
    setMobileSearch(false, { focus: false, skipMenuSync: true });
    updateHeaderOffsetVar();
    if (leftVisible || rightVisible) updateBackdropOffset();
    return;
  }

  const next = !!open;
  if (next) {
    setMobileSearch(false, { focus: false, skipMenuSync: true });
  }

  mobileMenuOpen = next;

  if (mobileMenuOpen && (leftVisible || rightVisible)) {
    closeColumns();
  }

  headerEl?.classList.toggle('menu-open', mobileMenuOpen);
  if (mobileMenuOpen) {
    headerEl?.classList.remove('hide');
  }
  mobileMenuToggle?.setAttribute('aria-expanded', String(mobileMenuOpen));
  menusContainer?.setAttribute('aria-hidden', String(!mobileMenuOpen));

  updateHeaderOffsetVar();
  if (leftVisible || rightVisible) updateBackdropOffset();
}

function setColAria() {
  if (leftEl)  leftEl.setAttribute('aria-hidden',  String(!leftVisible));
  if (rightEl) rightEl.setAttribute('aria-hidden', String(!rightVisible));
}

function syncMobileOverlays() {
  if (!isMobile()) {
    leftEl?.classList.remove('open');
    rightEl?.classList.remove('open');
    removeBackdrop();
    lockBodyScroll(false);
    return;
  }
  if (mobileSearchOpen) {
    leftEl?.classList.remove('open');
    rightEl?.classList.remove('open');
    removeBackdrop();
    lockBodyScroll(false);
    return;
  }
  leftEl?.classList.toggle('open',  !!leftVisible);
  rightEl?.classList.toggle('open', !!rightVisible);
  if (leftEl) {
    leftEl.style.zIndex = leftVisible && !rightVisible ? '2001' : '2000';
  }
  if (rightEl) {
    rightEl.style.zIndex = rightVisible && !leftVisible ? '2001' : '2000';
  }

  const anyOpen = !!leftVisible || !!rightVisible;
  if (anyOpen) {
    ensureBackdrop();
    updateBackdropOffset();
    lockBodyScroll(true);
  } else {
    removeBackdrop();
    lockBodyScroll(false);
  }
}

function closeColumns() {
  leftVisible = false;
  rightVisible = false;
  applyLayout();
}

function applyLayout(){
  updateHeaderOffsetVar();
  if (!gridEl) return;
  gridEl.classList.remove('left-closed','right-closed','both-closed','all-open');

  if (!leftVisible && !rightVisible) gridEl.classList.add('both-closed');
  else if (!leftVisible && rightVisible) gridEl.classList.add('left-closed');
  else if (leftVisible && !rightVisible) gridEl.classList.add('right-closed');
  else gridEl.classList.add('all-open');

  syncMobileOverlays();
  setColAria();
}

function openCol(side){
  const el = side === 'left' ? leftEl : rightEl;
  if (!el) return;

  const mobile = isMobile();
  if (side === 'left') {
    leftVisible = true;
    if (mobile) rightVisible = false;
  } else if (side === 'right') {
    rightVisible = true;
    if (mobile) leftVisible = false;
  }

  if (mobile) {
    applyLayout();
    return;
  }

  if (side === 'left')  leftEl.style.borderRight = '1px solid var(--ink)';
  if (side === 'right') rightEl.style.borderLeft  = '1px solid var(--ink)';

  applyLayout();
}

function closeCol(side){
  const el = side === 'left' ? leftEl : rightEl;
  if (!el) return;

  if (side === 'left')  leftVisible  = false;
  if (side === 'right') rightVisible = false;

  if (isMobile()) {
    applyLayout();
    return;
  }

  const propName = 'flex-basis';
  function onEnd(e){
    if (e.propertyName === propName) {
      if (side === 'left')  leftEl.style.borderRight = 'none';
      if (side === 'right') rightEl.style.borderLeft  = 'none';
      el.removeEventListener('transitionend', onEnd);
    }
  }
  el.addEventListener('transitionend', onEnd);
  applyLayout();
}

function toggleCol(side){
  const visible = side === 'left' ? leftVisible : rightVisible;
  if (visible) closeCol(side); else openCol(side);
}

function closeAll() {
  closeColumns();
  setMobileMenu(false);
  setMobileSearch(false, { focus: false, skipMenuSync: true });
}

document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && isMobile() && (leftVisible || rightVisible || mobileMenuOpen || mobileSearchOpen)) {
    e.preventDefault();
    closeAll();
  }
});


let resizeRaf = null;
window.addEventListener('resize', () => {
  if (resizeRaf) return;
  resizeRaf = requestAnimationFrame(() => {
    resizeRaf = null;
    const nowMobile = isMobile();
    updateHeaderOffsetVar();
    if (leftVisible || rightVisible) {
      updateBackdropOffset();
    }
    if (nowMobile !== lastMobile) {
      lastMobile = nowMobile;
      applyLayout();
      setMobileMenu(false);
      setMobileSearch(false, { focus: false, skipMenuSync: true });
    }
  });
});

createPaneCloseButtons();
applyLayout();
setMobileMenu(false);


    document.querySelectorAll('.menu a').forEach(a => {
      a.addEventListener('click', e => {
        e.preventDefault();
        const paneSide = a.dataset.pane;
        const target   = a.dataset.target;
        const isSearchTarget = paneSide === 'left' && target === 'zoeken';

        const menu = a.closest('.menu');
        const wasSelected = a.getAttribute('aria-selected') === 'true';

        menu.querySelectorAll('a').forEach(x => x.setAttribute('aria-selected','false'));
        a.setAttribute('aria-selected','true');

        if (!isSearchTarget) {
          resetSearchForm();
        }

        if (paneSide && target) setActivePane(paneSide, target);

        if (paneSide === 'left' && target !== 'zoeken') {
          previousLeftMenuSelection = a;
        }

        if (isMobile()) {
          if (isSearchTarget) {
            setMobileSearch(true, { focus: true, skipMenuSync: true });
            setMobileMenu(false);
          } else {
            setMobileSearch(false, { focus: false, skipMenuSync: true });
          }
        }

        if (paneSide === 'left') {
          if (wasSelected && leftVisible) {
            closeCol('left');
            a.setAttribute('aria-selected', 'false');
          } else {
            openCol('left');
          }
        } else if (paneSide === 'right') {
          if (wasSelected && rightVisible) {
            closeCol('right');
            a.setAttribute('aria-selected', 'false');
          } else {
            openCol('right');
          }
        }

        if (isMobile()) {
          setMobileMenu(false);
        }

        if (isSearchTarget) {
          focusSearchInput(isMobile());
        }

      });
    });

    mobileSearchToggle?.addEventListener('click', () => {
      const next = !mobileSearchOpen;
      setMobileSearch(next);
      if (next) {
        const searchLink = document.querySelector('.menu-left .menu a[data-target="zoeken"]');
        if (searchLink) {
          const currentSelection = document.querySelector('.menu-left .menu a[aria-selected="true"]');
          if (!searchActive && currentSelection && currentSelection.dataset.target !== 'zoeken') {
            previousLeftMenuSelection = currentSelection;
          }
          updateLeftMenuSelection(searchLink);
        }
      } else if (!searchActive && previousLeftMenuSelection) {
        updateLeftMenuSelection(previousLeftMenuSelection);
      }
    });

    mobileMenuToggle?.addEventListener('click', () => {
      setMobileMenu(!mobileMenuOpen);
    });

  
    document.getElementById('left-col')?.addEventListener('click', (e) => {
      const a = e.target.closest('a.author, a.reeks, a.genre, .pane a');
      if (!a) return;
      e.preventDefault();
      const parent = a.closest('.block2, ul, .block, section') || document;
      parent.querySelectorAll('a.author, a.reeks, a.genre, .pane a').forEach(x => x.classList?.remove('active'));
      a.classList?.add('active');

      const key = a.dataset.key || a.dataset.author || a.textContent.trim();
      renderTitles(titlesByKey[key] || []);

      if (isMobile()) {
        closeColumns();
        setMobileMenu(false);
      }
    });

    document.getElementById('right-col')?.addEventListener('click', (e) => {
      if (!isMobile()) return;
      const interactive = e.target.closest('a, button, input, textarea, select');
      if (!interactive) return;
      closeColumns();
      setMobileMenu(false);
    });

   
    (function init(){
      const leftActive  = document.querySelector('.menu-left  a[aria-selected="true"]')?.dataset.target || 'auteurs';
      const rightActive = document.querySelector('.menu-right a[aria-selected="true"]')?.dataset.target || 'over';
      setActivePane('left', leftActive);
      setActivePane('right', rightActive);
      const defaultLeftLink = document.querySelector(`.menu-left .menu a[data-target="${leftActive}"]`);
      if (defaultLeftLink) {
        updateLeftMenuSelection(defaultLeftLink);
        if (leftActive !== 'zoeken') {
          previousLeftMenuSelection = defaultLeftLink;
        }
      } else {
        updateLeftMenuSelection(null);
      }

      leftVisible = false;
      rightVisible = false;
      applyLayout();

      renderTitles(titlesByKey["Obe Alkema"] || []);
    })();
function isReadingMode() {
  const grid = document.getElementById('grid');
  const articleOpen = document.querySelector('.middle .block.open');
  if (isMobile()) {
    return !leftVisible && !rightVisible && !!articleOpen;
  }
  return grid?.classList.contains('both-closed') && !!articleOpen;
}

function onScroll(currentY, fromWindow = false, sourceEl = null) {
  const header = document.querySelector('header');

  if (!isReadingMode()) {
    if (header?.classList.contains('hide')) {
      header.classList.remove('hide');
      updateHeaderOffsetVar();
    }
    hidden = false;
    lastScrollY = currentY;
    ticking = false;
    return;
  }

  
  let atBottom = false;
  if (fromWindow) {
    atBottom = window.innerHeight + window.scrollY >= document.documentElement.scrollHeight - 5;
  } else if (sourceEl) {
    const remaining = sourceEl.scrollHeight - sourceEl.scrollTop - sourceEl.clientHeight;
    atBottom = remaining <= 5;
  }
  if (atBottom) {
    if (hidden && !isMobile()) {
      header?.classList.remove('hide');
      hidden = false;
      updateHeaderOffsetVar();
    }
    lastScrollY = currentY;
    ticking = false;
    return;
  }

  if (currentY > lastScrollY && currentY > 80) {
    if (!hidden) {
      header?.classList.add('hide');
      hidden = true;
      updateHeaderOffsetVar();
    }
  } else if (currentY < lastScrollY) {
    if (hidden) {
      header?.classList.remove('hide');
      hidden = false;
      updateHeaderOffsetVar();
    }
  }

  lastScrollY = currentY;
  if (backdropEl) updateBackdropOffset();
  ticking = false;
}


function attachScrollWatcher() {
  const activePane = document.querySelector('#middle-col .pane.active');
  if (!activePane) return;

  activePane.addEventListener('scroll', () => {
    if (!ticking) {
      requestAnimationFrame(() => onScroll(activePane.scrollTop, false, activePane));
      ticking = true;
    }
  });
}


attachScrollWatcher();

window.addEventListener('scroll', () => {
  if (!isMobile()) return;
  if (!ticking) {
    ticking = true;
    requestAnimationFrame(() => onScroll(window.scrollY, true));
  }
});

document.getElementById('middle-col')?.addEventListener('click', (e) => {
  if (e.target.closest('.title-toggle')) {
    setTimeout(attachScrollWatcher, 100);
  }
});

document.getElementById('middle-col')?.addEventListener('click', (e) => {
  closeColumns();
  document.querySelectorAll('.menu a').forEach(a => a.setAttribute('aria-selected','false'));
});


  </script>

{{ end }}

